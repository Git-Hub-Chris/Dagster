---
title: "Using Dagster with dbt, part 1: Set up the dbt project"
description: Dagster can orchestrate dbt alongside other technologies.
---

# Using dbt with Dagster, part one: Set up the dbt project

<Note>
  This is part one of the{" "}
  <a href="/integrations/dbt/using-dbt-with-dagster">
    Using dbt with Dagster software-defined assets
  </a>{" "}
  tutorial.
</Note>

First, you'll set up the dbt project for the tutorial. We're using dbt's example [jaffle shop project](https://github.com/dbt-labs/jaffle_shop), but you can follow along with a different project as well.

In this part, you'll:

- [Clone the jaffle_shop dbt project](#step-1-clone-the-jaffle_shop-dbt-project)
- [Create a DuckDB connection profile](#step-2-create-a-duckdb-profile)
- [Configure the project's `dbt_project.yml` file](#step-3-configure-the-dbt_projectyml-file)
- [Configure dbt model data sources](#step-4-configure-dbt-model-data-sources)

---

## Step 1: Clone the jaffle_shop dbt project

1. In the terminal, create a folder named `dbt_dagster_tutorial`:

   ```shell
   mkdir dbt_dagster_tutorial
   ```

2. Navigate into the new folder:

   ```shell
   cd dbt_dagster_tutorial
   ```

3. In the `dbt_dagster_tutorial` folder, clone the `jaffle_shop` dbt project:

   ```shell
   git clone https://github.com/dbt-labs/jaffle_shop.git
   ```

The folder structure should now be similar to the following:

```markdown file=/integrations/dbt/dbt_dagster_tutorial/project_structure.yaml startafter=part_one_structure_start endbefore=part_one_structure_end
- /dbt_dagster_tutorial
  - /jaffle_shop
    - README.md
    - dbt_project.yml
    - /models
      - customers.sql
      - orders.sql
      - schema.yml
      - /staging
        - schema.yml
        - stg_customers.sql
        - stg_orders.sql
    - /seeds
```

---

## Step 2: Create a DuckDB profile

In this step, you'll add a DuckDB profile to the dbt project. This will allow you to connect dbt to the DuckDB database.

1. Navigate into the `jaffle_shop` folder:

   ```shell
   cd jaffle_shop
   ```

2. Create a folder named `config`:

   ```shell
   mkdir config
   ```

3. In the `config` folder, create a `profile.yml` file that contains the following:

   ```yaml file=../../dbt_dagster_tutorial/jaffle_shop/config/profiles.yml
   jaffle_shop:
     target: local
     outputs:
       local:
         type: duckdb
         path: tutorial.duckdb
         schema: jaffle_shop
   ```

---

## Step 3: Configure the dbt_project.yml file

In this step, you'll verify that your dbt project's `dbt_project.yml` file is correctly configured. To work with this tutorial, this file must:

- Specify `jaffle_shop` as the `profile`:

  ```yaml
  profile: "jaffle_shop"
  ```

- Specify that `jaffle_shop` models are materialized into tables:

  ```yaml
  models:
    jaffle_shop:
      +materialized: table
  ```

---

## Step 4: Configure dbt model data sources

Next, you'll tell the models in your dbt project where the source data they depend on will be located. There isn't any data yet - in the next section, we'll create Dagster assets that fetch and provide data to the dbt models.

1. [Declare a source](https://docs.getdbt.com/docs/building-a-dbt-project/using-sources#declaring-a-source) by creating a `sources.yml` file in `/dbt_dagster_tutorial/jaffle_shop/models`. This defines the location of tables containing source data:

   ```yaml file=../../dbt_dagster_tutorial/jaffle_shop/models/sources.yml
   version: 2

   sources:
     - name: jaffle_shop
       tables:
         - name: orders_raw
         - name: customers_raw
   ```

2. Update the models in `dbt_dagster_tutorial/jaffle_shop/models/staging` to [select data from the sources you just declared](https://docs.getdbt.com/docs/building-a-dbt-project/using-sources#selecting-from-a-source).

   To do this, update the models' `FROM` statement to use the [`{{ source()}}` function](https://docs.getdbt.com/reference/dbt-jinja-functions/source). When finished, the files should look like the following:

   - For `stg_customers.sql`:

     ```sql file=../../dbt_dagster_tutorial/jaffle_shop/models/staging/stg_customers.sql
     select
         id as customer_id,
         first_name,
         last_name
     from {{ source('jaffle_shop', 'customers_raw') }}
     ```

   - For `stg_orders.sql`:

     ```sql file=../../dbt_dagster_tutorial/jaffle_shop/models/staging/stg_orders.sql
     select
         id as order_id,
         user_id as customer_id,
         order_date,
         status
     from {{ source('jaffle_shop', 'orders_raw') }}
     ```

---

## What's next?

At this point, you should have a fully-configured dbt project that's ready to work with Dagster. The next step is to [create Dagster assets and load the dbt models into Dagster](/integrations/dbt/using-dbt-with-dagster/part-two).
